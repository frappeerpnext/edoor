{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2023-11-28 14:23:28.725175",
 "css": "\n",
 "custom_format": 0,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Business Branch",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "format_data": "[{\"fieldname\": \"print_heading_template\", \"fieldtype\": \"Custom HTML\", \"options\": \"<div></div>\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Step 1 - Welcome \"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"1\\\" %}\\n<div class=\\\"text-center\\\" style=\\\"margin-top:36px\\\">\\n <h1>Welcome to Run Night Audit</h1>\\n <h5>Click on Next button to Continue</h5>\\n</div>\\n<div class=\\\"text-center\\\" style=\\\"margin-top:25px;padding-right:60px\\\">\\n <img width=\\\"250px\\\" src=\\\"/assets/edoor/images/icon-run-night-audit-gray.svg\\\">\\n</div> \\n{%endif%}\\n\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Step 2 - Today Arrival List\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"2\\\" %}\\n{%\\n\\nset data = frappe.db.sql(\\\"\\n    select \\n        name,\\n        reservation,\\n        reservation_type,\\n        reference_number,\\n        reservation_date,\\n        business_source,\\n        guest,\\n        guest_name, \\n        business_source, \\n        arrival_date, \\n        departure_date,\\n        reservation_status,\\n        room_type_alias,\\n        status_color,\\n        rooms,\\n        room_nights,\\n        adr,\\n        total_room_rate ,\\n        is_active_reservation\\n    from `tabReservation Stay` \\n    where \\n        property= '{0}' and\\n        is_active_reservation = 1 and\\n        arrival_date = '{1}' \\n        \\\".format(\\n            doc.name,\\n            frappe.form_dict.get('date')\\n        ),as_dict=1)\\n%}\\n{% if (data|length) >0 %}\\n<div class=\\\"primary_message\\\">\\n<h2>Today Arrival</h2>\\nToday, you have {{ data|selectattr(\\\"is_active_reservation\\\",\\\"equalto\\\",1)|list|length }} arrival reservations.\\n\\n  {%if (data|selectattr(\\\"reservation_status\\\",\\\"equalto\\\",\\\"Reserved\\\")|list|length) + (data|selectattr(\\\"reservation_status\\\",\\\"equalto\\\",\\\"Confirmed\\\")|list|length)>0 %}\\n    <span>There're {{ (data|selectattr(\\\"reservation_status\\\",\\\"equalto\\\",\\\"Reserved\\\")|list|length) + (data|selectattr(\\\"reservation_status\\\",\\\"equalto\\\",\\\"Confirmed\\\")|list|length) }} reservation pending to check-in.<br></span>\\n{%endif%}\\n\\nPlease review your reservation, perform check-in, or cancel. Then click on the \\\"Next\\\" button to continue.\\n</div>\\n\\n<table class='report-list occupied-001' style='width:100%'>\\n \\n        <tr>\\n            <th class=\\\"text-center\\\">No.</th>\\n            <th class=\\\"text-center\\\">Reservation #</th>\\n            <th class=\\\"text-center\\\">Stay #</th>\\n            <th class=\\\"text-center\\\">Ref. #</th>\\n            <th class=\\\"text-center\\\">Type</th>\\n            <th class=\\\"text-center\\\">Res. Date</th>\\n            \\n            <th class=\\\"text-center\\\">Stay Date</th>\\n            <th class=\\\"text-center\\\">Room Nights</th>\\n            <th>Room(s)</th>\\n            <th>Guest</th>\\n            <th>Source</th>\\n            <th class=\\\"text-end\\\">ADR</th>\\n            <th class=\\\"text-end\\\">Total Room Rate</th>\\n            <th class=\\\"text-center\\\">Status</th>\\n        </tr>\\n  \\n        {%for d in data%}\\n            <tr>\\n                <td class=\\\"text-center\\\">{{ loop.index }}</td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_detail|{{d.reservation}}', '*')\\\">{{d.reservation}}</a></td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_stay_detail|{{d.name}}', '*')\\\">{{d.name}}</a></td>\\n                <td class=\\\"text-center\\\">{{d.reference_number or \\\"\\\"}}</td>\\n                <td class=\\\"text-center\\\">{{d.reservation_type}}</td>\\n                <td class=\\\"text-center\\\">{{frappe.format(d.reservation_date,{'fieldtype':'Date'})}}</td>\\n               \\n                <td class=\\\"text-center\\\">{{frappe.format(d.arrival_date,{'fieldtype':'Date'})}} - {{frappe.format(d.departure_date,{'fieldtype':'Date'})}}</td>\\n                <td class=\\\"text-center\\\">{{d.room_nights}}</td>\\n                <td>\\n                    {% set rooms = frappe.db.sql(\\\"SELECT `name`,room_type,room_type_alias,room_number FROM `tabReservation Stay Room` WHERE parent = '{0}'\\\".format(d.name),as_dict=1) %}\\n                    {% if (rooms|length)>0 %}\\n                        {% for room in rooms %}\\n                          <span title=\\\"{{room.room_type}}\\\">{{room.room_type_alias}}</span>/{% if room.room_number %} {{room.room_number}} {%else%} <a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('assign_room|{{d.name}}|{{room.name}}', '*')\\\">Assign</a>{% endif %}{{ \\\"\\\" if loop.last else \\\", \\\" }}\\n                        {% endfor %}\\n                    {% endif %}\\n                </td>\\n                <td><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_guest_detail|{{d.guest}}', '*')\\\">{{d.guest}} - {{d.guest_name}}</a></td>\\n                <td>{{d.business_source}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.adr,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.total_room_rate,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-center\\\"><span style=\\\"background: {{d.status_color}}\\\" class=\\\"rounded-pill py-1 px-2 text-white\\\">{{d.reservation_status}}</span></td>\\n            </tr>\\n        {%endfor%}\\n     \\n</table>\\n{% else %}\\n<div class=\\\"mt-4 print-heading text-center p-2\\\">\\n    <div class=\\\"isemtyIcon\\\"></div> \\n    <small class=\\\"text-emty\\\">Today no arrivals guest to check-in.</small>\\n</div>\\n{%endif%}\\n{%endif%}\\n\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Step 3 - Today Departure\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"3\\\" %}\\n{%\\n\\nset data = frappe.db.sql(\\\"\\n    select \\n        name,\\n        reservation,\\n        reservation_type,\\n        reference_number,\\n        reservation_date,\\n        business_source,\\n        guest,\\n        guest_name, \\n        business_source, \\n        arrival_date, \\n        departure_date,\\n        reservation_status,\\n        room_type_alias,\\n        status_color,\\n        rooms,\\n        room_nights,\\n        adr,\\n        total_room_rate \\n    from `tabReservation Stay` \\n    where \\n        property= '{0}' and \\n        departure_date = '{1}' and \\n        reservation_status in ('Checked Out', 'In-House')\\n        \\\".format(\\n            doc.name,\\n            frappe.form_dict.get('date')\\n        ),as_dict=1)\\n%}\\n{% if (data|length) >0 %}\\n<div class=\\\"primary_message\\\">\\n<h2>Today Departure</h2>\\n\\nYou have {{data|length}} rooms to check out today. \\n {%if  data|selectattr(\\\"reservation_status\\\",\\\"equalto\\\",\\\"In-house\\\")|list|length >0 %}\\n    There're {{data|selectattr(\\\"reservation_status\\\",\\\"equalto\\\",\\\"In-house\\\")|list|length}} room pending to check out. <br>\\n    Please review your reservation and perform check out or extend stay then click on button Next to continue\\n{%else%}\\n    <br/> Click on \\\"Next\\\" to continue.\\n{%endif%}\\n\\n\\n\\n</div>\\n<table class='report-list occupied-001' style='width:100%'>\\n \\n        <tr>\\n            <th class=\\\"text-center\\\">No.</th>\\n            <th class=\\\"text-center\\\">Reservation #</th>\\n            <th class=\\\"text-center\\\">Stay #</th>\\n            <th class=\\\"text-center\\\">Ref. #</th>\\n            <th class=\\\"text-center\\\">Type</th>\\n            <th class=\\\"text-center\\\">Res. Date</th>\\n            \\n            <th class=\\\"text-center\\\">Stay Date</th>\\n            <th class=\\\"text-center\\\">Room Nights</th>\\n            <th>Room(s)</th>\\n            <th>Guest</th>\\n            <th>Source</th>\\n            <th class=\\\"text-end\\\">ADR</th>\\n            <th class=\\\"text-end\\\">Total Room Rate</th>\\n            <th class=\\\"text-center\\\">Status</th>\\n        </tr>\\n  \\n        {%for d in data%}\\n            <tr>\\n                <td class=\\\"text-center\\\">{{ loop.index }}</td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_detail|{{d.reservation}}', '*')\\\">{{d.reservation}}</a></td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_stay_detail|{{d.name}}', '*')\\\">{{d.name}}</a></td>\\n                <td class=\\\"text-center\\\">{{d.reference_number or \\\"\\\"}}</td>\\n                <td class=\\\"text-center\\\">{{d.reservation_type}}</td>\\n                <td class=\\\"text-center\\\">{{frappe.format(d.reservation_date,{'fieldtype':'Date'})}}</td>\\n               \\n                <td class=\\\"text-center\\\">{{frappe.format(d.arrival_date,{'fieldtype':'Date'})}} - {{frappe.format(d.departure_date,{'fieldtype':'Date'})}}</td>\\n                <td class=\\\"text-center\\\">{{d.room_nights}}</td>\\n                <td>{{d.room_type_alias}} {{\\\"/\\\" if d.rooms else \\\"\\\"}} {{d.rooms}}</td>\\n                <td><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_guest_detail|{{d.guest}}', '*')\\\">{{d.guest}} - {{d.guest_name}}</a></td>\\n                <td>{{d.business_source}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.adr,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.total_room_rate,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-center\\\"><span style=\\\"background: {{d.status_color}}\\\" class=\\\"rounded-pill py-1 px-2 text-white\\\">{{d.reservation_status}}</span></td>\\n            </tr>\\n        {%endfor%}\\n     \\n</table>\\n{% else %}\\n<div class=\\\"mt-4 print-heading text-center p-2\\\">\\n    <div class=\\\"isemtyIcon\\\"></div>\\n    <small class=\\\"text-emty\\\">Today no pending reservations to check out.</small>\\n</div>\\n{%endif%}\\n{%endif%}\\n\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Step 4 - Today Reservation\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"4\\\" %}\\n{%\\n\\nset data = frappe.db.sql(\\\"\\n    select \\n        name,\\n        reservation,\\n        reservation_type,\\n        reference_number,\\n        reservation_date,\\n        business_source,\\n        guest,\\n        guest_name, \\n        business_source, \\n        arrival_date, \\n        departure_date,\\n        reservation_status,\\n        room_type_alias,\\n        status_color,\\n        rooms,\\n        room_nights,\\n        adr,\\n        total_room_rate ,\\n        is_active_reservation\\n    from `tabReservation Stay` \\n    where \\n        property= '{0}' and\\n        reservation_date = '{1}' \\n        \\\".format(\\n            doc.name,\\n            frappe.form_dict.get('date')\\n        ),as_dict=1)\\n%}\\n\\n<div class=\\\"primary_message\\\">\\n<h2>Today Reservation</h2>\\nToday, you have created {{data|count}} reservation(s)(\\n{{data|selectattr('reservation_status','equalto','Reserved')|list|length}} Reserved, \\n{{data|selectattr('reservation_status','equalto','Confirmed')|list|length}} Confirmed, \\n{{data|selectattr('reservation_status','equalto','In-house')|list|length}} In-house, \\n{{data|selectattr('reservation_status','equalto','Checked Out')|list|length}} Checked Out, \\n{{data|selectattr('reservation_status','equalto','No Show')|list|length}} No-Show, \\n{{data|selectattr('reservation_status','equalto','Cancelled')|list|length}} Cancelled, \\n{{data|selectattr('reservation_status','equalto','Void')|list|length}} Void\\n)\\n<br>Click on the \\\"Next\\\" button to continue.\\n</div>\\n\\n<table class='report-list occupied-001' style='width:100%;margin-bottom:20px;'>\\n    <tr>\\n        <th class=\\\"bg-header-table text-white fw-semibold\\\" colspan=\\\"17\\\" ><strong>Today Reservation</strong></th>\\n    </tr>\\n {% if (data|length) >0 %}\\n        <tr>\\n            <th class=\\\"text-center\\\">No.</th>\\n            <th class=\\\"text-center\\\">Reservation #</th>\\n            <th class=\\\"text-center\\\">Stay #</th>\\n            <th class=\\\"text-center\\\">Ref. #</th>\\n            <th class=\\\"text-center\\\">Type</th>\\n            <th class=\\\"text-center\\\">Res. Date</th>\\n            \\n            <th class=\\\"text-center\\\">Stay Date</th>\\n            <th class=\\\"text-center\\\">Room Nights</th>\\n            <th>Room(s)</th>\\n            <th>Guest</th>\\n            <th>Source</th>\\n            <th class=\\\"text-end\\\">ADR</th>\\n            <th class=\\\"text-end\\\">Total Room Rate</th>\\n            <th class=\\\"text-center\\\">Status</th>\\n        </tr>\\n  \\n        {%for d in data%}\\n            <tr>\\n                <td class=\\\"text-center\\\">{{ loop.index }}</td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_detail|{{d.reservation}}', '*')\\\">{{d.reservation}}</a></td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_stay_detail|{{d.name}}', '*')\\\">{{d.name}}</a></td>\\n                <td class=\\\"text-center\\\">{{d.reference_number or \\\"\\\"}}</td>\\n                <td class=\\\"text-center\\\">{{d.reservation_type}}</td>\\n                <td class=\\\"text-center\\\">{{frappe.format(d.reservation_date,{'fieldtype':'Date'})}}</td>\\n               \\n                <td class=\\\"text-center\\\">{{frappe.format(d.arrival_date,{'fieldtype':'Date'})}} - {{frappe.format(d.departure_date,{'fieldtype':'Date'})}}</td>\\n                <td class=\\\"text-center\\\">{{d.room_nights}}</td>\\n                <td>\\n                    {% set rooms = frappe.db.sql(\\\"SELECT `name`,room_type,room_type_alias,room_number FROM `tabReservation Stay Room` WHERE parent = '{0}'\\\".format(d.name),as_dict=1) %}\\n                    {% if (rooms|length)>0 %}\\n                        {% for room in rooms %}\\n                          <span title=\\\"{{room.room_type}}\\\">{{room.room_type_alias}}</span>/{% if room.room_number %} {{room.room_number}} {%else%} <a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('assign_room|{{d.name}}|{{room.name}}', '*')\\\">Assign</a>{% endif %}{{ \\\"\\\" if loop.last else \\\", \\\" }}\\n                        {% endfor %}\\n                    {% endif %}\\n                </td>\\n                <td><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_guest_detail|{{d.guest}}', '*')\\\">{{d.guest}} - {{d.guest_name}}</a></td>\\n                <td>{{d.business_source}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.adr,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.total_room_rate,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-center\\\"><span style=\\\"background: {{d.status_color}}\\\" class=\\\"rounded-pill py-1 px-2 text-white\\\">{{d.reservation_status}}</span></td>\\n            </tr>\\n        {%endfor%}\\n     {% else %}\\n</table>\\n\\n<div class=\\\"mt-4 print-heading text-center p-2\\\">\\n    <div class=\\\"isemtyIcon\\\"></div> \\n    <small class=\\\"text-emty\\\">Today no Reservation was created</small>\\n</div>\\n{%endif%}\\n{%endif%}\\n\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"4\\\" %}\\n{%\\n\\nset data = frappe.db.sql(\\\"\\n    select \\n        name,\\n        reservation,\\n        reservation_type,\\n        reference_number,\\n        reservation_date,\\n        business_source,\\n        guest,\\n        guest_name, \\n        business_source, \\n        arrival_date, \\n        departure_date,\\n        reservation_status,\\n        room_type_alias,\\n        status_color,\\n        rooms,\\n        room_nights,\\n        adr,\\n        total_room_rate ,\\n        is_active_reservation\\n    from `tabReservation Stay` \\n    where \\n        property= '{0}' and\\n        cancelled_date = '{1}' and\\n        reservation_status in ('Cancelled','No Show','Void')\\n        \\\".format(\\n            doc.name,\\n            frappe.form_dict.get('date')\\n        ),as_dict=1)\\n%}\\n\\n<table class='report-list occupied-001' style='width:100%;margin-bottom:20px;'>\\n    <tr>\\n        <th class=\\\"bg-header-table text-white fw-semibold\\\" colspan=\\\"17\\\" ><strong>Today No-show/Cancelled/Void</strong></th>\\n    </tr>\\n {% if (data|length) >0 %}\\n        <tr>\\n            <th class=\\\"text-center\\\">No.</th>\\n            <th class=\\\"text-center\\\">Reservation #</th>\\n            <th class=\\\"text-center\\\">Stay #</th>\\n            <th class=\\\"text-center\\\">Ref. #</th>\\n            <th class=\\\"text-center\\\">Type</th>\\n            <th class=\\\"text-center\\\">Res. Date</th>\\n            \\n            <th class=\\\"text-center\\\">Stay Date</th>\\n            <th class=\\\"text-center\\\">Room Nights</th>\\n            <th>Room(s)</th>\\n            <th>Guest</th>\\n            <th>Source</th>\\n            <th class=\\\"text-end\\\">ADR</th>\\n            <th class=\\\"text-end\\\">Total Room Rate</th>\\n            <th class=\\\"text-center\\\">Status</th>\\n        </tr>\\n  \\n        {%for reservation_status in data | map(attribute='reservation_status') | unique %}\\n            <tr>\\n                <td><strong>{{reservation_status}}</strong></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>\\n            </tr>\\n            {% for d in data | selectattr('reservation_status','equalto',reservation_status) | list %}\\n            <tr>\\n                <td class=\\\"text-center\\\">{{ loop.index }}</td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_detail|{{d.reservation}}', '*')\\\">{{d.reservation}}</a></td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_stay_detail|{{d.name}}', '*')\\\">{{d.name}}</a></td>\\n                <td class=\\\"text-center\\\">{{d.reference_number or \\\"\\\"}}</td>\\n                <td class=\\\"text-center\\\">{{d.reservation_type}}</td>\\n                <td class=\\\"text-center\\\">{{frappe.format(d.reservation_date,{'fieldtype':'Date'})}}</td>\\n               \\n                <td class=\\\"text-center\\\">{{frappe.format(d.arrival_date,{'fieldtype':'Date'})}} - {{frappe.format(d.departure_date,{'fieldtype':'Date'})}}</td>\\n                <td class=\\\"text-center\\\">{{d.room_nights}}</td>\\n                <td>\\n                    {% set rooms = frappe.db.sql(\\\"SELECT `name`,room_type,room_type_alias,room_number FROM `tabReservation Stay Room` WHERE parent = '{0}'\\\".format(d.name),as_dict=1) %}\\n                    {% if (rooms|length)>0 %}\\n                        {% for room in rooms %}\\n                          <span title=\\\"{{room.room_type}}\\\">{{room.room_type_alias}}</span>/{% if room.room_number %} {{room.room_number}} {%else%} <a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('assign_room|{{d.name}}|{{room.name}}', '*')\\\">Assign</a>{% endif %}{{ \\\"\\\" if loop.last else \\\", \\\" }}\\n                        {% endfor %}\\n                    {% endif %}\\n                </td>\\n                <td><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_guest_detail|{{d.guest}}', '*')\\\">{{d.guest}} - {{d.guest_name}}</a></td>\\n                <td>{{d.business_source}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.adr,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.total_room_rate,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-center\\\"><span style=\\\"background: {{d.status_color}}\\\" class=\\\"rounded-pill py-1 px-2 text-white\\\">{{d.reservation_status}}</span></td>\\n            </tr>\\n        {%endfor%}\\n        {% endfor %}\\n     {% else %}\\n</table>\\n\\n<div class=\\\"mt-4 print-heading text-center p-2\\\">\\n    <div class=\\\"isemtyIcon\\\"></div> \\n    <small class=\\\"text-emty\\\">No Data</small>\\n</div>\\n{%endif%}\\n{%endif%}\\n\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"4\\\" %}\\n{%\\n\\nset data = frappe.db.sql(\\\"\\n    select \\n        name,\\n        reservation,\\n        reservation_type,\\n        reference_number,\\n        reservation_date,\\n        business_source,\\n        guest,\\n        guest_name, \\n        business_source, \\n        arrival_date, \\n        departure_date,\\n        reservation_status,\\n        room_type_alias,\\n        status_color,\\n        rooms,\\n        room_nights,\\n        adr,\\n        total_room_rate ,\\n        is_active_reservation\\n    from `tabReservation Stay` \\n    where \\n        property= '{0}' and\\n        arrival_date = '{1}' and\\n        reservation_status in ('Cancelled', 'Void')\\n        \\\".format(\\n            doc.name,\\n            frappe.form_dict.get('date')\\n        ),as_dict=1)\\n%}\\n\\n<table class='report-list occupied-001' style='width:100%;margin-bottom:20px;'>\\n    <tr>\\n        <th class=\\\"bg-header-table text-white fw-semibold\\\" colspan=\\\"17\\\" ><strong>Cancelled/Void</strong></th>\\n    </tr>\\n {% if (data|length) >0 %}\\n        <tr>\\n            <th class=\\\"text-center\\\">No.</th>\\n            <th class=\\\"text-center\\\">Reservation #</th>\\n            <th class=\\\"text-center\\\">Stay #</th>\\n            <th class=\\\"text-center\\\">Ref. #</th>\\n            <th class=\\\"text-center\\\">Type</th>\\n            <th class=\\\"text-center\\\">Res. Date</th>\\n            \\n            <th class=\\\"text-center\\\">Stay Date</th>\\n            <th class=\\\"text-center\\\">Room Nights</th>\\n            <th>Room(s)</th>\\n            <th>Guest</th>\\n            <th>Source</th>\\n            <th class=\\\"text-end\\\">ADR</th>\\n            <th class=\\\"text-end\\\">Total Room Rate</th>\\n            <th class=\\\"text-center\\\">Status</th>\\n        </tr>\\n  \\n        {%for reservation_status in data | map(attribute='reservation_status') | unique%}\\n            <tr>\\n                <td><strong>{{reservation_status}}</strong></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n                <td></td>\\n            </tr>\\n            {% for d in data | selectattr('reservation_status','equalto',reservation_status) | list %}\\n            <tr>\\n                <td class=\\\"text-center\\\">{{ loop.index }}</td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_detail|{{d.reservation}}', '*')\\\">{{d.reservation}}</a></td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_stay_detail|{{d.name}}', '*')\\\">{{d.name}}</a></td>\\n                <td class=\\\"text-center\\\">{{d.reference_number or \\\"\\\"}}</td>\\n                <td class=\\\"text-center\\\">{{d.reservation_type}}</td>\\n                <td class=\\\"text-center\\\">{{frappe.format(d.reservation_date,{'fieldtype':'Date'})}}</td>\\n               \\n                <td class=\\\"text-center\\\">{{frappe.format(d.arrival_date,{'fieldtype':'Date'})}} - {{frappe.format(d.departure_date,{'fieldtype':'Date'})}}</td>\\n                <td class=\\\"text-center\\\">{{d.room_nights}}</td>\\n                <td>\\n                    {% set rooms = frappe.db.sql(\\\"SELECT `name`,room_type,room_type_alias,room_number FROM `tabReservation Stay Room` WHERE parent = '{0}'\\\".format(d.name),as_dict=1) %}\\n                    {% if (rooms|length)>0 %}\\n                        {% for room in rooms %}\\n                          <span title=\\\"{{room.room_type}}\\\">{{room.room_type_alias}}</span>/{% if room.room_number %} {{room.room_number}} {%else%} <a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('assign_room|{{d.name}}|{{room.name}}', '*')\\\">Assign</a>{% endif %}{{ \\\"\\\" if loop.last else \\\", \\\" }}\\n                        {% endfor %}\\n                    {% endif %}\\n                </td>\\n                <td><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_guest_detail|{{d.guest}}', '*')\\\">{{d.guest}} - {{d.guest_name}}</a></td>\\n                <td>{{d.business_source}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.adr,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.total_room_rate,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-center\\\"><span style=\\\"background: {{d.status_color}}\\\" class=\\\"rounded-pill py-1 px-2 text-white\\\">{{d.reservation_status}}</span></td>\\n            </tr>\\n        {%endfor%}\\n        {%endfor%}\\n        \\n     {% else %}\\n</table>\\n\\n<div class=\\\"mt-4 print-heading text-center p-2\\\">\\n    <div class=\\\"isemtyIcon\\\"></div> \\n    <small class=\\\"text-emty\\\">No Data</small>\\n</div>\\n{%endif%}\\n{%endif%}\\n\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"4\\\" %}\\n{%\\n\\nset data = frappe.db.sql(\\\"\\n    select \\n        name,\\n        reservation,\\n        reservation_type,\\n        reference_number,\\n        reservation_date,\\n        business_source,\\n        guest,\\n        guest_name, \\n        business_source, \\n        arrival_date, \\n        departure_date,\\n        reservation_status,\\n        room_type_alias,\\n        status_color,\\n        rooms,\\n        room_nights,\\n        adr,\\n        total_room_rate ,\\n        is_active_reservation\\n    from `tabReservation Stay` \\n    where \\n        property= '{0}' and\\n        reservation_status = 'No Show' and \\n        arrival_date <= '{1}' and\\n        departure_date > '{1}' and\\n        is_reserved_room = 1\\n        \\\".format(\\n            doc.name,\\n            frappe.form_dict.get('date')\\n        ),as_dict=1)\\n%}\\n\\n<table class='report-list occupied-001' style='width:100%;margin-bottom:20px;'>\\n    <tr>\\n        <th class=\\\"bg-header-table text-white fw-semibold\\\" colspan=\\\"17\\\" ><strong>No-Show(Reserved Room)</strong></th>\\n    </tr>\\n {% if (data|length) >0 %}\\n        <tr>\\n            <th class=\\\"text-center\\\">No.</th>\\n            <th class=\\\"text-center\\\">Reservation #</th>\\n            <th class=\\\"text-center\\\">Stay #</th>\\n            <th class=\\\"text-center\\\">Ref. #</th>\\n            <th class=\\\"text-center\\\">Type</th>\\n            <th class=\\\"text-center\\\">Res. Date</th>\\n            \\n            <th class=\\\"text-center\\\">Stay Date</th>\\n            <th class=\\\"text-center\\\">Room Nights</th>\\n            <th>Room(s)</th>\\n            <th>Guest</th>\\n            <th>Source</th>\\n            <th class=\\\"text-end\\\">ADR</th>\\n            <th class=\\\"text-end\\\">Total Room Rate</th>\\n            <th class=\\\"text-center\\\">Status</th>\\n        </tr>\\n        \\n        {%for arrival_date in data | map(attribute = 'arrival_date') | unique %}\\n\\n            <tr>\\n                <td><strong>{{frappe.format(arrival_date,{'fieldtype':'Date'})}}</strong></td>\\n                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>\\n            </tr>\\n            {% for d in data | selectattr('arrival_date','equalto',arrival_date) | list%}\\n            <tr>\\n                <td class=\\\"text-center\\\">{{ loop.index }}</td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_detail|{{d.reservation}}', '*')\\\">{{d.reservation}}</a></td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_stay_detail|{{d.name}}', '*')\\\">{{d.name}}</a></td>\\n                <td class=\\\"text-center\\\">{{d.reference_number or \\\"\\\"}}</td>\\n                <td class=\\\"text-center\\\">{{d.reservation_type}}</td>\\n                <td class=\\\"text-center\\\">{{frappe.format(d.reservation_date,{'fieldtype':'Date'})}}</td>\\n               \\n                <td class=\\\"text-center\\\">{{frappe.format(d.arrival_date,{'fieldtype':'Date'})}} - {{frappe.format(d.departure_date,{'fieldtype':'Date'})}}</td>\\n                <td class=\\\"text-center\\\">{{d.room_nights}}</td>\\n                <td>\\n                    {% set rooms = frappe.db.sql(\\\"SELECT `name`,room_type,room_type_alias,room_number FROM `tabReservation Stay Room` WHERE parent = '{0}'\\\".format(d.name),as_dict=1) %}\\n                    {% if (rooms|length)>0 %}\\n                        {% for room in rooms %}\\n                          <span title=\\\"{{room.room_type}}\\\">{{room.room_type_alias}}</span>/{% if room.room_number %} {{room.room_number}} {%else%} <a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('assign_room|{{d.name}}|{{room.name}}', '*')\\\">Assign</a>{% endif %}{{ \\\"\\\" if loop.last else \\\", \\\" }}\\n                        {% endfor %}\\n                    {% endif %}\\n                </td>\\n                <td><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_guest_detail|{{d.guest}}', '*')\\\">{{d.guest}} - {{d.guest_name}}</a></td>\\n                <td>{{d.business_source}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.adr,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.total_room_rate,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-center\\\"><span style=\\\"background: {{d.status_color}}\\\" class=\\\"rounded-pill py-1 px-2 text-white\\\">{{d.reservation_status}}</span></td>\\n            </tr>\\n        {% endfor %}\\n        {%endfor%}\\n     {% else %}\\n</table>\\n\\n<div class=\\\"mt-4 print-heading text-center p-2\\\">\\n    <div class=\\\"isemtyIcon\\\"></div> \\n    <small class=\\\"text-emty\\\">No Data</small>\\n</div>\\n{%endif%}\\n{%endif%}\\n\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Step 5 - Room Charge Posting\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"5\\\" %}\\n \\n {%\\n    set sql = \\\"\\n        select \\n            name,\\n            business_source,\\n            reservation,\\n            reservation_stay,\\n            input_rate, \\n            rate, \\n            total_tax, \\n            total_rate, \\n            room_number, \\n            room_type,\\n            room_type_alias,\\n            discount,\\n            rate_type,\\n            guest,\\n            guest_name,\\n            is_manual_rate\\n        \\n    from `tabReservation Room Rate`\\n    where\\n        date = date_add('{0}',interval 1 day) and \\n        property = '{1}' and \\n        is_active_reservation=1\\n    \\\".format(\\n        frappe.form_dict.get('date'),\\n       doc.name\\n    )\\n%}\\n{%\\n    set data = frappe.db.sql(sql, as_dict=1)\\n    \\n %}\\n \\n <div class=\\\"primary_message\\\">\\n <h2>Posting Room Charge</h2>\\n Your have {{data|length}} stay-over guests, Room changes will be automatically posted to the master folio after the system date changes.<br>\\n Please make sure the room rate is correct, then click on the \\\"Next\\\" button to continue.\\n </div>\\n \\n     {% if (data|length)>0 %}\\n      \\n      <table class='report-list occupied-001' style='width:100%'>\\n \\n        <tr>\\n            <th class=\\\"text-center\\\">No.</th>\\n            <th class=\\\"text-center\\\">Reservation #</th>\\n            <th class=\\\"text-center\\\">Stay #</th>\\n              <th>Room(s)</th>\\n            <th>Rate Type</th>\\n          \\n            <th>Guest</th>\\n            <th>Source</th>\\n            <th class=\\\"text-end\\\">Rate</th>\\n            <th class=\\\"text-end\\\">Discount</th>\\n            <th class=\\\"text-end\\\">Tax</th>\\n            <th class=\\\"text-end\\\">Total Rate</th>\\n            <th class=\\\"text-center\\\">Use Rate Plan</th>\\n        </tr>\\n  \\n        {%for d in data%}\\n            <tr>\\n                <td class=\\\"text-center\\\">{{ loop.index }}</td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_detail|{{d.reservation}}', '*')\\\">{{d.reservation}}</a></td>\\n                <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_stay_detail|{{d.reservation_stay}}', '*')\\\">{{d.reservation_stay}}</a></td>\\n\\n                <td>\\n                    {{d.room_type_alias}} / {{d.room_number}}\\n                </td>\\n                <td>{{d.rate_type}}</td>\\n                <td><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_guest_detail|{{d.guest}}', '*')\\\">{{d.guest_name}}</a></td>\\n                <td>{{d.business_source}}</td>\\n                <td class=\\\"text-end\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_edit_room_rate|{{d.name}}', '*')\\\">{{frappe.format(d.rate,{'fieldtype':'Currency'})}}</a></td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.discount,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.total_tax,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-end\\\">{{frappe.format(d.total_rate,{'fieldtype':'Currency'})}}</td>\\n                <td class=\\\"text-center\\\">{{\\\"Yes\\\" if d.is_manual_rate == 0 else \\\"No\\\"}}</td>\\n            </tr>\\n        {%endfor%}\\n     \\n</table>\\n      \\n     {% else %}\\n<div class=\\\"mt-4 print-heading text-center p-2\\\">\\n    <div class=\\\"isemtyIcon\\\"></div> \\n    <small class=\\\"text-emty\\\">You don't have pending reservation to check out</small>\\n</div>\\n     {%endif%}\\n     \\n \\n{%endif%}\\n\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Step 6 - Today Posting Folio Transaction\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"6\\\" %}\\n{%\\n    set sql = \\\"\\n            select \\n                name,\\n                reservation_stay,\\n                transaction_type,\\n                reservation,\\n                posting_date,\\n                room_number,\\n                room_type,\\n                room_type_alias,\\n                parent_reference,\\n                type,\\n                guest,\\n                guest_name,\\n                account_code,\\n                report_description as  account_name,\\n                report_quantity as quantity,\\n                input_amount,\\n                price,\\n                amount,\\n                discount_amount,\\n                transaction_number,\\n                total_tax,\\n                total_amount,\\n                bank_fee_amount,\\n                ifnull(note,'') as note,\\n                creation,\\n                owner,\\n                modified,\\n                modified_by\\n            from `tabFolio Transaction` \\n            where\\n                posting_date = '{0}'and\\n                property = '{1}' and \\n                ifnull(parent_reference,'') = '' \\n    \\\".format(\\n        frappe.form_dict.get('date'),\\n        doc.name\\n    )\\n\\n%}\\n{%\\n    set data = frappe.db.sql(sql, as_dict=1)\\n%}\\n\\n\\n \\n {% if (data|length) > 0 %}\\n <div class=\\\"primary_message\\\">\\n <h2>Today Posting Transaction</h2>\\n Today, there are {{data|length}} folio transactions posted to the system.<br>\\n Kindly review the Account Code and Rate. If the details are accurate, please mark the checkbox to confirm folio posting, then proceed by clicking \\\"Next\\\" to continue.\\n </div>\\n    <table class='report-list occupied-001' style='width:100%'>\\n        <tr>\\n           <th class=\\\"text-left\\\">No.</th>\\n            <th class=\\\"text-center\\\">Reservation #</th>\\n            <th class=\\\"text-center\\\">Stay #</th>\\n            <th class=\\\"text-center\\\">Folio #</th>\\n            <th class=\\\"text-center\\\">Folio Tran. #</th>\\n             <th>Room(s)</th>\\n             <th>Guest</th>\\n            <th>Account</th>\\n            <th class=\\\"text-center\\\">QTY</th>\\n            \\n            <th class=\\\"text-end\\\">Amount/Rate</th>\\n            <th class=\\\"text-end\\\">Discount</th>\\n            <th class=\\\"text-center\\\">Tax</th>\\n            <th class=\\\"text-center\\\">Bank Fee</th>\\n            <th class=\\\"text-center\\\">Total Amount</th>\\n            <th class=\\\"text-center\\\">Note</th>\\n            <th>By</th>\\n        </tr>\\n  \\n      {% for transaction_type in data | map(attribute='transaction_type') | unique  %}\\n      <tr>\\n          <td style=\\\"font-size:14px;padding:5px;\\\"><strong>{{transaction_type}}</strong></td>\\n          <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>\\n      </tr>\\n    {% for d in data | selectattr('transaction_type','equalto',transaction_type) | list %}\\n    <tr>\\n        <td class=\\\"text-left\\\">{{ loop.index }}</td>\\n        <td class=\\\"text-center\\\">{% if d.reservation %}<a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_detail|{{d.reservation}}', '*')\\\">{{d.reservation}}</a>{% else %}N/A{% endif %}</td>\\n        <td class=\\\"text-center\\\">{% if d.reservation_stay%}<a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_reservation_stay_detail|{{d.reservation_stay}}', '*')\\\">{{d.reservation_stay}}</a>{% else %}N/A{% endif %}</td>\\n        <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_{{d.transaction_type|replace(' ','_')|lower }}_detail|{{d.transaction_number}}', '*')\\\">{{d.transaction_number}}</a></td>\\n        <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_folio_transaction_detail|{{d.name}}', '*')\\\">{{d.name}}</a></td>\\n        <td>  {{d.room_number or ''}} {{ '/' if d.room_type_alias else '' }} {{d.room_type_alias or ''}}  </td>\\n        <td>{% if d.guest_name %}<a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_guest_detail|{{d.guest}}', '*')\\\">{{d.guest_name}}</a>{% else %}N/A{% endif %}</td>\\n        <td>{% if d.account_code or d.account_name %}{{d.account_code}} - {{d.account_name}}{% else %}N/A{% endif %}</td>\\n        <td class=\\\"text-end\\\">{{d.quantity if d.quantity> 0 else \\\"\\\" }}</td>\\n        <td class=\\\"text-end\\\">{{frappe.format(d.price,{'fieldtype':'Currency'})}}</td>\\n        <td class=\\\"text-end\\\">{{frappe.format(d.discount_amount,{'fieldtype':'Currency'})}}</td>\\n        <td class=\\\"text-end\\\">{{frappe.format(d.total_tax,{'fieldtype':'Currency'})}}</td>\\n        <td class=\\\"text-end\\\">{{frappe.format(d.bank_fee,{'fieldtype':'Currency'})}}</td>\\n        <td class=\\\"text-end\\\">{{frappe.format(d.total_amount,{'fieldtype':'Currency'})}}</td>\\n        <td>{{d.note}}</td> \\n        <td>{{d.owner.split(\\\"@\\\")[0]}}</td> \\n            </tr>\\n      {% endfor %}\\n      {% endfor %}\\n    </table>\\n\\n    {%set summary_data = frappe.db.sql(\\\"\\n            select \\n                account_category,\\n                account_category_sort_order, \\n                sum(amount * if(type='Debit',1,-1)) as amount \\n            from `tabFolio Transaction` \\n            where \\n                posting_date = '{0}' and \\n                property = '{1}'  \\n            group by \\n                account_category \\n            order by \\n                account_category_sort_order\\n        \\\".format(\\n            frappe.form_dict.get(\\\"date\\\"),\\n            doc.name    \\n        ),as_dict=1)%}\\n <br>\\n    <table class=\\\"table-print-format\\\">\\n        <tr>\\n            <th colspan=\\\"2\\\">   \\n                <h3>Summary</h3>\\n            </th>\\n        </tr>\\n        <tbody>\\n            {%for d in summary_data %}\\n            <tr>\\n               <td width=\\\"350px\\\">{{ d.account_category }}</td>\\n               <td class=\\\"text-right\\\">{{frappe.format_value(d.amount or 0,\\\"Currency\\\") }}</td>\\n            </tr>\\n            {%endfor%}\\n        </tbody>\\n      \\n    </table>\\n\\n        \\n {% else %}\\n<div class=\\\"mt-4 print-heading text-center p-2\\\">\\n    <div class=\\\"isemtyIcon\\\"></div> \\n    <small class=\\\"text-emty\\\">There're no folio transaction posting for today</small>\\n</div>\\n{%endif%}     \\n{%endif%}\\n\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Step 7 - Today Shift\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"7\\\" %}\\n{%set sql = \\\"select \\n                * \\n            from `tabCashier Shift` \\n            where \\n                posting_date = '{0}' and\\n                business_branch = '{1}'   \\n        \\n            \\\".format(\\n                frappe.form_dict.get(\\\"date\\\"),\\n                doc.name\\n            )\\n%}\\n{%\\n    set data = frappe.db.sql(sql,as_dict=1)\\n%}\\n<div class=\\\"primary_message\\\">\\n <h2>Today Shift</h2>\\n {%if data|selectattr(\\\"is_closed\\\",\\\"equalto\\\",0)|list|length > 0 %}\\n    You currently have {{data|selectattr(\\\"is_closed\\\",\\\"equalto\\\",0)|list|length}} open shifts. Kindly close all open shifts and proceed by clicking the \\\"Next\\\" button.\\n{%else%}\\n    All shifts are closed. Please click on the \\\"Next\\\" button to proceed.\\n {%endif%}\\n</div>\\n<table class='report-list occupied-001' style='width:100%'>\\n     <tr>\\n         <th class=\\\"text-center\\\">No</th>\\n         <th class=\\\"text-center\\\">Shift #</th>\\n         <th class=\\\"text-center\\\">Open Date</th>\\n         <th>Open By</th>\\n         <th class=\\\"text-end\\\">Opening Amount</th>\\n         <th class=\\\"text-end\\\">Close Amount</th>\\n\\n         <th class=\\\"text-center\\\">Close Date</th>\\n          <th>Close By</th>\\n         <th class=\\\"text-center\\\">Shift Type</th>\\n         <th class=\\\"text-center\\\">Status</th>\\n     </tr>\\n     {%for d in data %}\\n        <tr>\\n         <td class=\\\"text-center\\\">{{loop.index}}</td>\\n         \\n         <td class=\\\"text-center\\\"><a class=\\\"p-0 link_line_action1\\\" onclick=\\\"window.parent.postMessage('view_cashier_shift_detail|{{d.name}}', '*')\\\">{{d.name}}</a></td>\\n         <td class=\\\"text-center\\\">{{frappe.format_value(d.creation,\\\"Datetime\\\")}}</td>\\n         <td>{{d.owner.split(\\\"@\\\")[0]}}</td>\\n         <td class=\\\"text-end\\\">{{frappe.format_value(d.total_opening_amount,\\\"Currency\\\")}}</td>\\n         <td class=\\\"text-end\\\">{{frappe.format_value(d.total_close_amount,\\\"Currency\\\")}}</td>\\n         \\n         <td class=\\\"text-center\\\">{{frappe.format_value(d.closed_date,\\\"Datetime\\\") if d.is_closed ==\\\"1\\\" else \\\"\\\"}}</td>\\n            <td>{{ d.modified_by if d.is_closed ==\\\"1\\\" else \\\"\\\" }}</td>\\n         <td class=\\\"text-center\\\"> {{ \\\"eDoor Shift\\\" if d.is_edoor_shift ==1 else \\\"ePOS Shift\\\" }}</td>\\n         <td class=\\\"text-center\\\">{% if d.is_closed == 1 %}<span class=\\\"rounded-pill px-2\\\" style=\\\"background:#ececec\\\">Closed</span>{% else %}<span class=\\\"rounded-pill px-2\\\" style=\\\"background:#e6f4ea;color:#137333;\\\">Open</span>{% endif %}</td>\\n       \\n         \\n     </tr>\\n     {%endfor%}\\n </table>\\n \\n \\n{%endif%}\\n\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Step 8 - Finish\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"8\\\" %}\\n{% set data = frappe.call(\\\"edoor.api.frontdesk.get_dashboard_data\\\",property=doc.name,date=frappe.form_dict.get('date')) %}\\n<div class=\\\"primary_message\\\">\\n<!--<h2>Summary</h2>-->\\nKindly review the information below. Once you have confirmed that everything is accurate, click the \\\"Finish\\\" button to initiate the Night Audit.<br/>\\nThe upcoming day is scheduled for {{frappe.format(frappe.utils.add_to_date(data.working_date, days=1), {'fieldtype':'Date'})}}\\n</div> \\n<br/>\\n<div class=\\\"row\\\">\\n    <div class=\\\"col\\\">\\n        <h3>Summary</h3>\\n        <table class=\\\"table table-bordered report-list\\\">  \\n            <thead>\\n                <tr>\\n                   <th width=\\\"250px\\\">Summary</th>\\n                   <th class=\\\"text-right\\\">Value</th>\\n                </tr>\\n            </thead>\\n            <tbody>\\n                <tr>\\n                   <td width=\\\"250px\\\" style=\\\"font-weight:400 !important\\\">Arrival</td>\\n                   <td class=\\\"text-right\\\" style=\\\"font-weight:400 !important\\\">{{data.arrival|int}}</td>\\n                </tr>\\n                <tr>\\n                   <td>Departure</td>\\n                   <td class=\\\"text-right\\\">{{data.departure|int}}</td>\\n                </tr>  \\n                <tr>\\n                   <td>FIT Arrival</td>\\n                   <td class=\\\"text-right\\\"><span>Total Reservation {{data.fit_reservation_arrival|int}}</span> & <span>Total Stay {{data.fit_stay_arrival|int}}</span></td>\\n                </tr>\\n                <tr>\\n                   <td>GIT Arrival</td>\\n                   <td class=\\\"text-right\\\"><span>Total Reservation {{data.git_reservation_arrival|int}}</span> & <span>Total Stay {{data.git_stay_arrival|int}}</span></td>\\n                </tr>\\n                <tr>\\n                   <td>Stay Over</td>\\n                   <td class=\\\"text-right\\\">{{data.stay_over|int}}</td>\\n                </tr> \\n                <tr>\\n                   <td>No Show</td>\\n                   <td class=\\\"text-right\\\"><span>Today No-show {{data.today_no_show|int}}</span> & <span>No-show(Reserved Room) {{data.total_no_show|int}}</span></td>\\n                </tr>\\n                <tr>\\n                   <td>Cancel</td>\\n                   <td class=\\\"text-right\\\"><span>Today Cancelled {{data.today_cancelled|int}}</span> & <span>Cancelled {{data.total_cancelled|int}}</span></td>\\n                </tr>\\n                <tr>\\n                   <td>Void</td>\\n                   <td class=\\\"text-right\\\"><span>Today Void {{data.today_void|int}}</span> & <span>Void {{data.total_void|int}}</span></td>\\n                </tr> \\n                <tr>\\n                   <td>Pick-up</td>\\n                   <td class=\\\"text-right\\\">{{data.pick_up|int}}</td>\\n                </tr>\\n                <tr>\\n                   <td>Drop Off</td>\\n                   <td class=\\\"text-right\\\">{{data.drop_off|int}}</td>\\n                </tr>\\n                <tr>\\n                   <td>Daily Reservation</td>\\n                   <td class=\\\"text-right\\\">{{data.daily_reservation|int}}</td>\\n                </tr>\\n                <tr>\\n                   <td>Total Room Occupy</td>\\n                   <td class=\\\"text-right\\\">{{data.total_room_occupy|int}}</td>\\n                </tr>\\n                <tr>\\n                   <td>Total Room Vacant</td>\\n                   <td class=\\\"text-right\\\">{{data.total_room_vacant|int}}</td>\\n                </tr>\\n                <tr>\\n                   <td>Total Room Block</td>\\n                   <td class=\\\"text-right\\\">{{data.total_room_block|int}}</td>\\n                </tr> \\n            </tbody>\\n        </table> \\n    </div>\\n    <div class=\\\"col\\\">\\n        {%set summary_data = frappe.db.sql(\\\"\\\"\\\"\\n            select \\n                transaction_type,\\n                account_category,\\n                account_category_sort_order,\\n                sum(report_quantity) as quantity, \\n                sum(amount * if(type='Debit',1,-1)) as amount \\n            from `tabFolio Transaction` \\n            where \\n                working_date = '{}' \\n            group by \\n                transaction_type,\\n                account_category \\n            order by account_category_sort_order\\n            \\\"\\\"\\\".format(\\n                frappe.form_dict.get(\\\"date\\\")\\n            ),as_dict=1)%}\\n        \\n        {%set ledger= ['Reservation Folio','Deposit Ledger','City Ledger','Desk Folio', 'Payable Ledger']%}\\n        \\n        {%for l in ledger%}\\n        {%if  (summary_data|selectattr('transaction_type','==',l)|sum(attribute='amount'))!=0  %}\\n            <h3>{{'Guest Ledger' if l=='Reservation Folio' else l}}</h3>\\n            <table class=\\\"table table-bordered report-list\\\">\\n                <thead>\\n                <tr>\\n                    <th>{{_('Summary')}} </th>    \\n                    <th class='text-center'>QTY</th>    \\n                    <th class='text-end'>Amount</th>    \\n                    \\n                </tr>\\n                \\n                    \\n                </thead>\\n                <tbody>\\n                    {%for d in summary_data|selectattr('transaction_type','==',l) %}\\n                    <tr>\\n                        <td style=\\\"font-weight:400 !important\\\">{{ d.account_category }}</td>\\n                        <td style=\\\"font-weight:400 !important\\\" class='text-center' style=\\\"width:100px\\\">{{ frappe.format(d.quantity,'Float') }}</td>\\n                        <td style=\\\"font-weight:400 !important\\\" class=\\\"text-end\\\" style=\\\"width:150px\\\">{{frappe.format_value(d.amount or 0,\\\"Currency\\\") }}</td>\\n                    </tr>\\n                    {%endfor%}\\n                </tbody>\\n                <tfoot>\\n                    <tr>\\n                        <td colspan=\\\"2\\\"><strong>Balance</strong></td>\\n                        <td class=\\\"text-end\\\"><strong>{{frappe.format_value(summary_data|selectattr('transaction_type','==',l)|sum(attribute='amount'),\\\"Currency\\\")}}</strong></td>\\n                        \\n                    </tr>\\n                </tfoot>\\n               \\n            </table>\\n         {%endif%}    \\n         <!--end if check if ledger have transaction-->\\n         {%endfor%} \\n    </div>\\n</div> \\n{%endif%}\\n\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Step 9 -  Thank You\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get(\\\"step\\\") ==\\\"9\\\" %}\\n <h1>Congratulation!</h1>\\n <p>You have successfully completed the Run Night Audit process.</p> \\n <p>The system date has been changed to 20-07-2023 (Static).</p> \\n <p>Please print report below to your supervisor.</p>\\n <hr/>\\n \\n the report list \\n \\n <ul>\\n     <li>Report 1</li>\\n     <li>Report 2</li>\\n     <li>Report 3</li>\\n     <li>Report 4</li>\\n </ul>\\n{%endif%}\\n\"}]",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2023-12-07 16:49:35.292699",
 "modified_by": "Administrator",
 "module": "eDoor",
 "name": "eDoor Run Night Audit Step",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}