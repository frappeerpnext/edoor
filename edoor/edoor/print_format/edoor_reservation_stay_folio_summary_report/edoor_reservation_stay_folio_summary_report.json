{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2023-09-22 21:20:21.250662",
 "css": "*{\r\n    color:#000!important;\r\n}\r\ntable{\r\n    border:none!important;\r\n}\r\n.report-list {\r\n    margin-top: 10px !important;\r\n    margin-bottom: 10px !important;\r\n}\r\n.report-list td,.tbl-payment-list td {\r\n    padding-top: 6px!important;\r\n    padding-bottom: 6px!important;\r\n}\r\n.tbl-list tr td,.tbl-list-summary table tr td {\r\n    padding: 4px 0px !important;\r\n    font-size: 13px !important;\r\n    border:none!important;\r\n}\r\n.tbl-list tr td:nth-child(2), .tbl-list-summary table tr td:nth-child(2){\r\n    padding-left: 4px !important;\r\n    padding-right: 4px !important;\r\n}\r\n.tbl-list-right tr td:nth-child(3), .tbl-list-summary table tr td:nth-child(3){\r\n    text-align: right;\r\n}\r\n.report-list thead {\r\n    background: silver;\r\n    border-bottom:solid 1px #000!important;\r\n}\r\n.report-list tfoot {\r\n    border-top:double 1px #000!important;\r\n}\r\n.report-list thead tr th {\r\n    color: #000;\r\n    font-weight: 600;\r\n}\r\n.report-list th, .report-list td {\r\n    border: none!important\r\n}\r\n.tbl-list-summary table tr td:nth-child(3) {\r\n    min-width: 100px;\r\n}\r\n.tbl-payment-list tbody td {\r\n    border-top: none !important;\r\n}\r\n\r\n.print-format .row:not(.section-break)\r\n{\r\n    margin-top:5px!important;\r\n}\r\n.print-format .letter-head{\r\n\r\n    margin-bottom:5px!important;\r\n}\r\n.print-heading{\r\n    border-bottom:solid 1px #000!important;\r\n}\r\n.print-format td, .print-format th{\r\n    padding: 4px 0px!important;\r\n}\r\n",
 "custom_format": 0,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Reservation Stay",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "format_data": "[{\"fieldname\": \"print_heading_template\", \"fieldtype\": \"Custom HTML\", \"options\": \"<center>\\n    <div class=\\\"print-heading\\\">\\n        <h2>INVOICE</h2>\\n    </div>\\n</center>\\n\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"<table style=\\\"width:100%;font-size:13px; margin-bottom:4px\\\">\\n    <tr>\\n        <td width=\\\"150px\\\">{{_(\\\"Guest Name\\\")}}</td>\\n        <td>: {{doc.guest_name or ''}}</td>\\n        <td width=\\\"150px\\\">{{_(\\\"Folio No.\\\")}}</td>\\n        <td>: {{frappe.form_dict.get(\\\"folio\\\") or ''}}</td>\\n    </tr>\\n    <tr>\\n        <td width=\\\"150px\\\">{{_(\\\"Nationality\\\")}}</td>\\n        <td>: {{doc.nationality or ''}}</td>\\n        <td>{{_(\\\"Date\\\")}}</td>\\n        <td>: {{ frappe.format_value(frappe.db.get_value(\\\"Reservation Folio\\\",frappe.form_dict.get(\\\"folio\\\"),\\\"posting_date\\\"),\\\"Date\\\")}}</td>\\n    </tr>\\n    <tr>\\n        <td>{{_(\\\"Business Source\\\")}}</td>\\n        <td>: {{doc.business_source}}</td>\\n        <td>{{_(\\\"Check-in\\\")}}</td>\\n        <td>: {{frappe.format(doc.arrival_date,{'fieldtype':'Date'}) or ''}}</td>\\n    </tr>\\n    <tr>\\n        <td width=\\\"150px\\\">{{_(\\\"Email Address\\\")}}</td>\\n        <td>: {{doc.guest_email or ''}}</td>\\n        <td>{{_(\\\"Check-out\\\")}}</td>\\n        <td>: {{frappe.format(doc.departure_date,{'fieldtype':'Date'}) or ''}}</td>\\n    </tr>\\n    <tr>\\n        <td>{{_(\\\"Rate Type\\\")}}</td>\\n        <td>: {{doc.rate_type}}</td>\\n        <td>{{_(\\\"Room\\\")}}</td>\\n        <td>: {{doc.rooms or ''}}</td>\\n\\n    </tr>\\n    \\n</table>\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Credit Debit Style\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if (frappe.form_dict.get(\\\"invoice_style\\\") or \\\"Simple Style\\\") == \\\"Debit/Credit Style\\\"%}\\n{% set data = frappe.call(\\\"edoor.api.reservation.get_folio_transaction_summary\\\",transaction_type='Reservation Folio', transaction_number=frappe.form_dict.get(\\\"folio\\\"),sort_by_field='account_category_sort_order',show_room_number=frappe.form_dict.get(\\\"show_room_number\\\"),show_account_code=frappe.form_dict.get(\\\"show_account_code\\\")) %}\\n{%set show_room_number = frappe.form_dict.get(\\\"show_room_number\\\") or 0 %}\\n\\n<table class=\\\"table table-bordered report-list\\\">\\n    <thead>\\n        <tr>\\n            <th class=\\\"text-center\\\">No</th>  \\n            {%if show_room_number==\\\"1\\\"%}\\n                <th class=\\\"text-center\\\">Room</th>    \\n            {%endif%}\\n            <th>Description</th>    \\n            <th class='text-center'>QTY</th>\\n            <th class=\\\"text-right\\\">Debit</th>    \\n            <th class=\\\"text-right\\\">Credit</th>    \\n            <th class=\\\"text-right\\\">Balance</th>    \\n        </tr>\\n    </thead>\\n\\n    <tbody>\\n        {% for d in data %}\\n        <tr>\\n            <td class='text-center'>{{loop.index}}</td>\\n            {%if show_room_number==\\\"1\\\" %}\\n                <td class='text-center'>{{d.room_number or ''}}</td>\\n            {%endif%}\\n            <td>{{d.description or ''}}</td>\\n            <td class='text-center'>{{ frappe.format_value(d.quantity,'Float') }}</td>\\n            <td class=\\\"text-right\\\">{{frappe.format_value(d.debit or 0,\\\"Currency\\\") }}</td>\\n            <td class=\\\"text-right\\\">{{frappe.format_value(d.credit or 0,\\\"Currency\\\") }}</td>\\n            <td class=\\\"text-right\\\">{{frappe.format_value(d.balance or 0,\\\"Currency\\\") }}</td>\\n        </tr> \\n        {% endfor %}\\n    </tbody>\\n\\n    <tfoot>\\n        <tr>\\n                <td colspan=\\\"{{ 3 if show_room_number=='1' else 2 }}\\\">\\n                    <strong>Balance</strong>\\n                </td>\\n                \\n                <td class=\\\"text-center\\\"><strong>\\n                    {{ frappe.format_value(data|sum(attribute='quantity'),'Float')}}\\n                </strong></td>\\n                <td class=\\\"text-right\\\"><strong>\\n                    {{frappe.format_value((data |sum(attribute='debit')),\\\"Currency\\\")}}\\n                </strong></td>\\n                <td class=\\\"text-right\\\"><strong>\\n                    {{frappe.format_value((data |sum(attribute='credit')),\\\"Currency\\\")}}\\n                </strong></td>\\n                <td class=\\\"text-right\\\"><strong>\\n                    {{frappe.format_value((data |sum(attribute='debit')) - (data |sum(attribute='credit')),\\\"Currency\\\")}}\\n                </strong></td>\\n            </tr>\\n    </tfoot>\\n</table>\\n{%endif%}\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Simple Style\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if (frappe.form_dict.get(\\\"invoice_style\\\") or \\\"Simple Style\\\") == \\\"Simple Style\\\"%}\\n{%set show_room_number = frappe.form_dict.get(\\\"show_room_number\\\") or 0 %}\\n{%set sql =\\\"\\\"\\\"\\n    select \\n        {0}\\n        account_code,\\n        report_description,\\n        sum(report_quantity) as quantity,\\n        (input_amount  + bank_fee_amount) * if(type='Debit',1,-1) as price,\\n        sum(discount_amount * if(type='Debit',1,-1)) as discount_amount,\\n        sum(total_tax * if(type='Debit',1,-1)) as total_tax,\\n        sum(bank_fee_amount * if(type='Debit',-1,1)) as bank_fee_amount,\\n        sum((total_amount - bank_fee_amount) * if(type='Debit',1,-1) ) as total_amount\\n    from `tabFolio Transaction` \\n    where \\n        transaction_type ='Reservation Folio' and\\n        transaction_number = '{1}' and \\n        ifnull(parent_reference,'')=''\\n    group by \\n        {0}\\n        account_code,\\n        price,\\n        (input_amount  + bank_fee_amount) * if(type='Debit',1,-1),\\n        report_description ,\\n        account_code_sort_order\\n        \\n    order by \\n    {0}\\n    account_code_sort_order\\n\\\"\\\"\\\".format(\\n        '' if frappe.form_dict.get(\\\"show_room_number\\\") ==\\\"0\\\" else \\\"room_number,\\\",\\n        frappe.form_dict.get(\\\"folio\\\")\\n\\n        \\n    )\\n%}\\n{% set show_account_code =  frappe.form_dict.get(\\\"show_account_code\\\") %} \\n\\n{% set data = frappe.db.sql(sql,as_dict=1) %}\\n{% set total_tax = (data|sum(attribute='total_tax')) or 0 %}\\n{% set total_bank_fee = (data|sum(attribute='bank_fee_amount')) or 0 %}\\n<table class=\\\"table table-bordered report-list\\\">\\n    <thead>\\n        <tr>\\n            <th class=\\\"text-center\\\">No</th>\\n            {% if show_room_number==\\\"1\\\"%}\\n                <th class=\\\"text-center\\\">Room</th>\\n            {%endif%}\\n            <th>Description</th>    \\n            <th class=\\\"text-center\\\">QTY</th>    \\n            <th class=\\\"text-right\\\">Price</th>    \\n            <th class=\\\"text-right\\\">Dis.</th>    \\n            {% if total_tax> 0 %}\\n                <th class=\\\"text-right\\\">Tax</th>    \\n            {%endif%}\\n            \\n            {% if total_bank_fee!= 0 %}\\n                <th class=\\\"text-right\\\">Bank Fee</th>    \\n            {%endif%}\\n            \\n            \\n            <th class=\\\"text-right\\\">Total Amt</th>    \\n        </tr>\\n    </thead>\\n\\n    <tbody>\\n        {% for d in data %}\\n        <tr>\\n            <td class=\\\"text-center\\\">{{loop.index}}</td>\\n            {% if show_room_number==\\\"1\\\"%}\\n            <td class=\\\"text-center\\\">{{d.room_number}}</td>\\n            {%endif%}\\n           <td>{{d.account_code + \\\"-\\\" if show_account_code==\\\"1\\\" else \\\"\\\"}}{{d.report_description or \\\"\\\"}}</td>\\n           <td class=\\\"text-center\\\">{{ frappe.format_value(d.quantity,'Float')}}</td>\\n           <td class=\\\"text-right\\\">{{frappe.format_value(d.price,\\\"Currency\\\") }}</td>\\n           <td class=\\\"text-right\\\">{{frappe.format_value(d.discount_amount,\\\"Currency\\\") }}</td>\\n            {% if total_tax> 0 %}\\n                <td class=\\\"text-right\\\">{{frappe.format_value(d.total_tax,\\\"Currency\\\") }}</td>\\n            {%endif%}\\n            {% if total_bank_fee != 0 %}\\n                <td class=\\\"text-right\\\">{{frappe.format_value(d.bank_fee_amount,\\\"Currency\\\") }}</td>\\n            {%endif%}\\n            <td class=\\\"text-right\\\">{{frappe.format_value(d.total_amount ,\\\"Currency\\\") }}</td>\\n           \\n        </tr> \\n        {% endfor %}\\n    </tbody>\\n<tfoot>\\n        <tr>\\n            <td colspan=\\\"{{3 if show_room_number=='1' else 2}}\\\">\\n                <strong>Total</strong>\\n            </td>\\n            <td class=\\\"text-center\\\">\\n                <strong>\\n                    {{frappe.format_value( data | sum(attribute='quantity'),\\\"Float\\\")}}\\n                </strong>\\n            </td>\\n            <td class=\\\"text-right\\\">\\n                <strong>\\n                    {{frappe.format_value(data|sum(attribute='price'),\\\"Currency\\\") }}\\n                </strong>\\n            </td>\\n            <td class=\\\"text-right\\\">\\n                <strong>\\n                    {{frappe.format_value(data|sum(attribute='discount_amount'),\\\"Currency\\\") }}\\n                </strong>\\n            </td>\\n            {% if total_tax> 0 %}\\n                <td class=\\\"text-right\\\">\\n                    <strong>\\n                        {{frappe.format_value(total_tax,\\\"Currency\\\") }}\\n                    </strong>\\n                </td>\\n            {%endif%}\\n            {% if total_bank_fee!= 0 %}\\n                <td class=\\\"text-right\\\">\\n                    <strong>\\n                        {{frappe.format_value(total_bank_fee,\\\"Currency\\\") }}\\n                    </strong>\\n                </td>\\n            {%endif%}\\n            <td class=\\\"text-right\\\">\\n                <strong>\\n                    {{frappe.format_value(data|sum(attribute='total_amount'),\\\"Currency\\\") }}\\n                </strong>\\n            </td>\\n            \\n        </tr>\\n    </tfoot>\\n</table>\\n{%endif%}\\n\\n \"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"_custom_html\", \"print_hide\": 0, \"label\": \"Custom HTML\", \"fieldtype\": \"HTML\", \"options\": \"{% if frappe.form_dict.get('show_summary')==\\\"1\\\" %}\\n\\n{%set summary_data = frappe.db.sql(\\\"select account_category,account_category_sort_order,sum(report_quantity) as quantity, sum(amount * if(type='Debit',1,-1)) as amount from `tabFolio Transaction` where transaction_number = '{}' group by account_category order by account_category_sort_order\\\".format(frappe.form_dict.get(\\\"folio\\\")),as_dict=1)%}\\n\\n<table class=\\\"table table-bordered report-list\\\">\\n    <thead>\\n    <tr>\\n        <th>{{_('Summary')}}</th>    \\n        <th class='text-center'>QTY</th>    \\n        <th class='text-right'>Amount</th>    \\n        \\n    </tr>\\n    \\n        \\n    </thead>\\n    <tbody>\\n        {%for d in summary_data %}\\n        <tr>\\n        <td>{{ d.account_category }}</td>\\n        <td class='text-center'>{{ frappe.format(d.quantity,'Float') }}</td>\\n           <td class=\\\"text-right\\\">{{frappe.format_value(d.amount or 0,\\\"Currency\\\") }}</td>\\n        </tr>\\n        {%endfor%}\\n    </tbody>\\n    <tfoot>\\n        <tr>\\n            <td colspan=\\\"2\\\"><strong>Balance</strong></td>\\n            <td class=\\\"text-right\\\"><strong>{{frappe.format_value(summary_data|sum(attribute='amount'),\\\"Currency\\\")}}</strong></td>\\n            \\n        </tr>\\n    </tfoot>\\n   \\n</table>\\n{%endif%}\"}]",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2023-11-21 23:28:52.614433",
 "modified_by": "Administrator",
 "module": "eDoor",
 "name": "eDoor Reservation Stay Folio Summary Report",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}